<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Select Subject</title>

  <link rel="stylesheet" href="css/futuristic.css">
  <link rel="stylesheet" href="css/theme.css">

  <style>
    /* small page-specific tweaks */
    .hero-img { width:100%; height:240px; object-fit:cover; display:block; filter:brightness(0.85); border-bottom:1px solid rgba(0,0,0,0.06); }
    .clean-hero { padding: 18px 24px 6px; background:var(--bg); color:var(--text); }
    .clean-hero h1 { margin:10px 0 6px; font-size:40px; font-weight:800; color:var(--text); text-shadow:0 6px 18px rgba(0,0,0,0.04); }
    .clean-hero p  { margin:0;color:var(--muted); }

    .subjects-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(360px,1fr));
      gap:22px; max-width:1150px; margin:28px auto 90px; padding:0 20px;
    }

    .resource-label{ display:inline-flex; align-items:center; gap:10px; background:linear-gradient(90deg,#9b5fff,#6c63ff); color:#fff; padding:8px 14px; border-radius:16px; font-weight:700; font-size:15px; box-shadow:0 8px 30px rgba(108,99,255,0.12); margin-bottom:12px; }

    .subject-card{ background:var(--card); padding:26px; border-radius:14px; border:1px solid var(--glass); box-shadow:var(--shadow); transition:transform .16s ease,box-shadow .16s ease; min-height:120px; display:flex; flex-direction:column; justify-content:space-between; }
    .subject-card:hover{ transform:translateY(-6px); box-shadow:0 20px 40px rgba(0,0,0,0.08); cursor:pointer; }

    .subject-title{ font-size:20px; font-weight:800; color:var(--text); margin:6px 0; }
    .subject-desc{ color:var(--muted); font-size:14px; margin-bottom:12px; }
    .subject-meta{ color:var(--muted); font-size:13px; }

    .open-btn{ background:linear-gradient(90deg,var(--accent),var(--accent-2)); border:none; color:#fff; padding:8px 14px; border-radius:12px; cursor:pointer; font-weight:700; }

    @media (max-width:720px){
      .clean-hero h1{ font-size:28px; }
      .subjects-grid{ padding:0 14px; gap:16px; }
    }

    /* make sure top hero text remains visible in both modes */
    .page-crumb { color:var(--muted); margin-top:6px; }
  </style>
</head>
<body>

  <!-- theme toggle (required so theme.js can find the buttons) -->
  <div style="position:fixed; right:18px; top:12px; z-index:200;">
    <button id="light" title="Light" style="margin-right:8px;padding:8px 10px;border-radius:8px;background:#fff;color:#111;border:none;cursor:pointer">ðŸŒž</button>
    <button id="dark"  title="Dark"  style="padding:8px 10px;border-radius:8px;background:transparent;color:#fff;border:1px solid rgba(255,255,255,0.12);cursor:pointer">ðŸŒ™</button>
  </div>

  <!-- HERO IMAGE: MUST exist at img/hero.png -->
  <img class="hero-img" src="img/hero.png" alt="Hero image">

  <!-- header text -->
  <header class="clean-hero" role="banner">
    <h1 id="pageTitle">Select Subject</h1>
    <div class="page-crumb" id="pagePath">Loadingâ€¦</div>
  </header>

  <!-- subjects grid -->
  <main>
    <section class="subjects-grid" id="subjectGrid"></section>
  </main>

  <footer style="text-align:center;padding:20px 0;color:var(--muted)">Â© Notes Portal</footer>

  <!-- theme setup (runs on DOMContentLoaded inside theme.js) -->
  <script type="module" src="js/theme.js"></script>

  <!-- main script: use ES module so we can import navigation.js -->
  <script type="module">
    import { setSubject } from "./js/navigation.js";

    // Semester subjects for sem 1 â€” modify if you need different lists for other sems
    const subjects = [
      "Applied Chemistry",
      "Applied Mathematics I",
      "Applied Physics I",
      "Communication Skills",
      "Engineering Graphics",
      "Engineering Mechanics",
      "Electrical Science",
      "Environmental Science",
      "Human Values and Professional Ethics",
      "Indian Constitution",
      "Manufacturing Processes",
      "Programming in C",
      "Workshop Practice"
    ];

    // Read saved selections (set earlier by course/branch/semester pages)
    const selectedCourse = localStorage.getItem('selectedCourse') || 'B.Tech';
    const selectedBranch = localStorage.getItem('selectedBranch') || localStorage.getItem('branch') || 'CSE';
    const selectedSemester = localStorage.getItem('selectedSemester') || localStorage.getItem('selectedSemester') || localStorage.getItem('semester') || 'Semester 1';

    // update crumb/path
    document.getElementById('pagePath').textContent = `${selectedCourse} â€¢ ${selectedBranch} â€¢ ${selectedSemester}`;

    // render subject cards and attach event listeners (no inline onclick)
    const grid = document.getElementById('subjectGrid');

    subjects.forEach(name => {
      const card = document.createElement('div');
      card.className = 'subject-card';

      card.innerHTML = `
        <div>
          <div class="resource-label"><span class="icon">ðŸ“˜</span><span>Syllabus</span></div>
          <div class="subject-title">${escapeHtml(name)}</div>
          <div class="subject-desc">Click to open resources for this subject</div>
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between;">
          <div class="subject-meta">${selectedBranch}</div>
          <div style="display:flex;gap:10px;align-items:center">
            <button class="open-btn" aria-label="Open ${escapeHtml(name)}">Open</button>
          </div>
        </div>
      `;

      // clicking the whole card should also open subject
      card.addEventListener('click', () => {
        localStorage.setItem('selectedSubject', name);
        // use navigation helper if available
        if (typeof setSubject === 'function') {
          setSubject(name);
        } else {
          location.href = 'subject-options.html';
        }
      });

      // stop event duplication on inner button (already handled)
      card.querySelector('.open-btn').addEventListener('click', (ev) => {
        ev.stopPropagation();
        localStorage.setItem('selectedSubject', name);
        if (typeof setSubject === 'function') {
          setSubject(name);
        } else {
          location.href = 'subject-options.html';
        }
      });

      grid.appendChild(card);
    });

    function escapeHtml(s) {
      return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,"&#39;");
    }
  </script>
</body>
</html>

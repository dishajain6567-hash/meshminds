<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viewer</title>

<link rel="stylesheet" href="css/futuristic.css">
<link rel="stylesheet" href="css/theme.css">

<style>
body {
  background: var(--bg);
  color: var(--text);
  margin: 0;
}

.top-bar {
  display: flex;
  justify-content: space-between;
  padding: 14px 20px;
  background: var(--card);
  align-items: center;
  border-bottom: 1px solid var(--border);
}

.top-bar button {
  background: var(--accent);
  color: #fff;
  padding: 8px 15px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

.viewer-box {
  width: 100%;
  height: calc(100vh - 70px);
  background: #000;
}

iframe {
  width: 100%;
  height: 100%;
  border: none;
}
</style>
</head>

<body>

<div class="top-bar">
  <button onclick="history.back()">⬅ Back</button>
  <div style="font-size:18px;font-weight:600;" id="titleTxt">Preview</div>
  <a id="downloadBtn" class="glow-btn" href="#" download target="_blank">Download</a>
</div>

<div class="viewer-box">
  <iframe id="viewerFrame"></iframe>
</div>

<script type="module" src="js/theme.js"></script>

<script>
// get link from URL
const urlParams = new URLSearchParams(window.location.search);
const fileUrl = urlParams.get("url");
const title = urlParams.get("title") || "Document";

document.getElementById("titleTxt").innerText = title;

// set viewer + download link
document.getElementById("downloadBtn").href = fileUrl;

// auto-embed Google Drive / PDF / images
let viewer = document.getElementById("viewerFrame");

// CASE 1 → PDF / drive link
if (fileUrl.includes("drive.google.com")) {
    viewer.src = "https://drive.google.com/file/d/" +
                 extractDriveId(fileUrl) +
                 "/preview";
}
else if (fileUrl.endsWith(".pdf")) {
    viewer.src = fileUrl;
}
// CASE 2 → Image
else if (fileUrl.match(/\.(jpg|jpeg|png|gif)$/i)) {
    viewer.src = fileUrl;
}
// CASE 3 → Fallback
else {
    viewer.src = fileUrl;
}

// Extract drive ID automatically
function extractDriveId(link) {
    let match = link.match(/[-\w]{25,}/);
    return match ? match[0] : "";
}
</script>

</body>
</html>
